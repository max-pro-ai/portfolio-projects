# AI ChatBot Assistant (Плагін WordPress)

AI ChatBot Assistant — це плагін WordPress, що додає на сайт віджет чату на базі OpenAI. Він зберігає переписку «користувач–бот» і, після налаштованого тайм-ауту неактивності, надсилає історію листування на e‑mail та (за бажання) у Telegram.

Важливо: для своєчасної доставки потрібен працюючий WP‑Cron (системний cron або зовнішній «пінгер»). Плагін ставить завдання на стороні сервера, незалежно від браузера.

## Можливості
- Віджет чату з налаштовуваним інтерфейсом (розмір, кольори, шрифти, тексти)
- Інтеграція з OpenAI з вибором моделі (сучасні значення за замовчуванням)
- Збереження листування в БД; локальний кеш для зручності перегляду
- Постановка історії в чергу на сервері після тайм-ауту
- Надсилання e‑mail через PHP mail() і опціонально в Telegram
- Надійні повтори; черга видаляється лише після успішної доставки

## Як це працює
1) Користувач надсилає повідомлення → плагін зберігає листування в БД.
2) Сервер ставить завдання з часом відправлення: час останнього повідомлення + тайм-аут.
3) Щохвилинне завдання (cron) обробляє «готові» історії та надсилає їх на пошту (+ Telegram, якщо ввімкнено).
4) Після успішної доставки в усі канали файл черги видаляється. У разі помилки — повторна спроба пізніше.

Примітка: UI тримає коротку локальну копію листування для UX, але «джерелом істини» для доставки є серверна черга.

## Вимоги
- WordPress 5.8+
- PHP 7.4+
- Дозволена вихідна пошта для PHP mail()
- (Опційно) Telegram Bot Token і Chat ID
- Активний WP‑Cron (рекомендується системний cron або зовнішній «пінгер»)

## Встановлення
1) Завантажте каталог `ai-chatbot-plugin` у `wp-content/plugins/`.
2) Активуйте «AI ChatBot Assistant» на сторінці Плагіни.
3) Перейдіть у Налаштування → AI ChatBot і вкажіть:
   - OpenAI API ключ і модель
   - Зовнішній вигляд віджета і тексти
   - E‑mail одержувача
   - Тайм-аут неактивності (мс)
   - Telegram (опційно): токен бота і Chat ID

## Налаштування cron (рекомендується)
- Системний cron (бажано):
  - Щохвилини: php /path/to/wordpress/wp-cron.php >/dev/null 2>&1
- Або HTTP‑пінгер (наприклад, UptimeRobot):
  - Щохвилини: https://ВАШ_САЙТ/wp-cron.php?doing_wp_cron
- Переконайтеся, що у wp-config.php НЕ встановлено DISABLE_WP_CRON = true.

## Діагностика
- Історії приходять лише після візиту на сайт:
  - Ймовірно, не працює WP‑Cron. Налаштуйте системний cron або зовнішній пінгер.
- Пошта не приходить:
  - Перевірте, що хостинг дозволяє PHP mail(); перевірте спам; адресу в налаштуваннях; перегляньте wp-content/debug.log.
- Telegram не приходить:
  - Перевірте Bot Token і Chat ID; протестуйте з налаштувань; перегляньте debug.log.

## Документація
- README англійською: README.md
- README російською: README-ru.md
- Архітектура та схема потоків: docs/SCHEMA.md

## Ліцензія
Проєкт надається «як є» власником сайту; додайте файл ліцензії, якщо плануєте публічне поширення.
